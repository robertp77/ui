(function(e){function t(t){for(var r,o,s=t[0],c=t[1],u=t[2],l=0,d=[];l<s.length;l++)o=s[l],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&d.push(i[o][0]),i[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);p&&p(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},i={app:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var p=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"38c8":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("e792"),n("0cdd");var r=n("2b0e"),i=n("5f5b"),a=n("b1e0");n("ab8b"),n("2dd8");r["default"].use(i["a"]),r["default"].use(a["a"]);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("a",{attrs:{href:e.apiUrlBase+"api/auth/login"}},[e._v("Login")]),n("br"),n("a",{attrs:{href:e.apiUrlBase+"api/auth/logout"}},[e._v("Logout")]),n("br"),n("the-map")],1)},s=[],c=(n("99af"),n("b0c0"),n("1da1")),u=(n("d3b7"),n("96cf"),n("b383")),p=n.n(u),l="";function d(e,t,n,r){return h.apply(this,arguments)}function h(){return h=Object(c["a"])(regeneratorRuntime.mark((function e(t,n,r,i){var a,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=r?"?".concat(p.a.stringify(r)):"",o="".concat(t).concat(n).concat(a),console.log(o),e.next=5,fetch(o,i);case 5:return s=e.sent,e.abrupt("return",s.json());case 7:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function g(){return f.apply(this,arguments)}function f(){return f=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){navigator.geolocation.getCurrentPosition(e,t)})));case 1:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}var v={data:function(){return[]},useRemoteServer:!0,initData:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d(l,"api/getLinks");case 2:e.data=t.sent,console.log("Getting initial version of data");case 4:case"end":return t.stop()}}),t)})))()},getnewlat:function(e){return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,g();case 2:if(n=t.sent,r=n.coords.latitude,void 0==e){t.next=7;break}return t.next=7,fetch("https://safe-river-16409.herokuapp.com/api/sendlat?lat="+r+"&name="+e);case 7:return t.abrupt("return",r);case 8:case"end":return t.stop()}}),t)})))()},getnewlng:function(e){return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,g();case 2:if(n=t.sent,r=n.coords.longitude,void 0==e){t.next=7;break}return t.next=7,fetch("https://safe-river-16409.herokuapp.com/api/sendlong?long="+r+"&name="+e);case 7:return t.abrupt("return",r);case 8:case"end":return t.stop()}}),t)})))()},setTitle:function(e,t){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:console.log("Setting title from ".concat(n.data[e].title," to ").concat(t));case 1:case"end":return r.stop()}}),r)})))()},addLink:function(e,t){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:console.log("Adding new link ".concat(t.name," to group ").concat(n.data[e].title));case 1:case"end":return r.stop()}}),r)})))()}},m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"mapwrap"}},[n("header",[n("h1",[e._v(e._s(e.score)+" miles available for ride requests. Complete ride requests on the map to earn more miles! "+e._s(e.isloading))])]),n("div",{attrs:{id:"mapContainer"}}),n("b-button",{attrs:{id:"request"},on:{click:e.setpickup}},[e._v(e._s(e.reqstatus))])],1)},k=[],b=(n("d81d"),n("07ac"),n("ddb0"),n("e11e")),w=n("ac00"),x=(n("6cc5"),n("1615"),n("7faa")),q=n.n(x),y={name:"TheMap",data:function(){return{allLinks:v,map:"test",pickuploc:"init",reqstatus:"request ride",provider:"test",searchControl:"test",reqpickuploc:"test",reqdropoffloc:"test",thert:"test",pickuplat:0,pickuplong:0,lat:0,long:0,userid:"",ispick:"",thepopup:"",thegiveridepopups:[],cost:"",riderid:"",enroute:!1,thebtns:[],inds:[],yesbtns:[],nobtns:[],containers:[],giving:!1,okbtns:[],loggedin:!1,loggedin2:!1,requested:!1,theuserid:{},otherreqstatus:!1,score:15,isloading:"(loading map)"}},methods:{getrides:function(){return Object(c["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://safe-river-16409.herokuapp.com/api/getLinks");case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)})))()},getriderlat:function(e){return Object(c["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://safe-river-16409.herokuapp.com/api/getriderlat?id="+e);case 2:return n=t.sent,t.abrupt("return",n.json());case 4:case"end":return t.stop()}}),t)})))()},getriderlong:function(e){return Object(c["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://safe-river-16409.herokuapp.com/api/getriderlong?id="+e);case 2:return n=t.sent,t.abrupt("return",n.json());case 4:case"end":return t.stop()}}),t)})))()},work:function(e){console.log(e.location),this.pickuploc.setLatLng([e.location.y,e.location.x])},updatePoly:function(e){this.thert.remove(),this.thert=b["polygon"]([[this.pickuplat,this.pickuplong],[e.latlng.lat,e.latlng.lng]]).addTo(this.map)},conpick:function(){var e=this;this.pickuploc.on("move",this.confirm2),this.pickuplat=this.pickuploc.getLatLng().lat,this.pickuplong=this.pickuploc.getLatLng().lng,this.thert=b["polygon"]([[this.pickuplat,this.pickuplong],[this.pickuplat,this.pickuplong+.003]]).addTo(this.map),this.reqpickuploc=b["circle"]([this.pickuplat,this.pickuplong],{color:"green",fillColor:"green",fillOpacity:.5,radius:25}).addTo(this.map),this.pickuploc.setLatLng([this.pickuplat,this.pickuplong+.003]),this.pickuploc.on("move",this.updatePoly),this.thepopup.setLatLng([this.pickuplat+.003/Math.pow(this.map.getZoom(),9)*Math.pow(13,9),this.pickuplong+.003]);var t=b["DomUtil"].create("div"),n=b["DomUtil"].create("button","",t),r=b["DomUtil"].create("button","",t);n.setAttribute("type","button"),r.setAttribute("type","button"),n.innerHTML="confirm dropoff",r.innerHTML="cancel",b["DomEvent"].on(n,"click",Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.condrop();case 2:case"end":return t.stop()}}),t)})))),b["DomEvent"].on(r,"click",(function(){e.reqpickuploc.remove(),e.thert.remove(),e.pickuploc.remove(),e.otherreqstatus=!1,e.thepopup.remove()}));var i=document.createElement("div");i.appendChild(n),i.appendChild(r),this.thepopup.setContent(i),this.thepopup.openOn(this.map)},condrop:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(void 0!=e.theuserid||0!=e.loggedin2){t.next=11;break}return window.location.assign("https://safe-river-16409.herokuapp.com/api/auth/login"),e.loggedin2=!0,t.next=5,e.use();case 5:return n=t.sent,e.theuserid=n.id,t.next=9,e.condrop();case 9:t.next=44;break;case 11:if(void 0!=e.theuserid||1!=e.loggedin2){t.next=21;break}return t.next=14,e.use();case 14:return r=t.sent,e.theuserid=r.id,console.log(e.theuserid),t.next=19,e.condrop();case 19:t.next=44;break;case 21:return t.next=23,e.getgive();case 23:if(e.givingans=t.sent,void 0==e.givingans.requested||"False"==e.givingans.requested?e.requested=!1:e.requested=!0,0!=e.requested){t.next=43;break}return t.next=28,fetch("https://safe-river-16409.herokuapp.com/api/changerequested",{credentials:"include"});case 28:return e.reqdropoffloc=b["circle"]([e.pickuploc.getLatLng().lat,e.pickuploc.getLatLng().lng],{color:"red",fillColor:"red",fillOpacity:.5,radius:25}).addTo(e.map),e.thepopup.remove(),e.pickuploc.remove(),e.reqstatus="cancel request (5 mile penalty)",e.requested=!0,e.otherreqstatus=!1,t.next=36,e.getscore();case 36:return e.oldscore=t.sent,t.next=39,fetch("https://safe-river-16409.herokuapp.com/api/sendride?requestedpickuplat="+e.pickuplat+"&requestedpickuplong="+e.pickuplong+"&requesteddropofflat="+e.pickuploc.getLatLng().lat+"&requesteddropofflong="+e.pickuploc.getLatLng().lng,{credentials:"include"});case 39:return t.next=41,e.checkriderdest(e.oldscore);case 41:t.next=44;break;case 43:alert("You have already requested a ride");case 44:case"end":return t.stop()}}),t)})))()},waitfordriver:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.getscore();case 2:if(t.score=n.sent,t.score!=e){n.next=8;break}return n.next=6,t.waitfordriver(e);case 6:n.next=9;break;case 8:console.log("success");case 9:case"end":return n.stop()}}),n)})))()},getscore:function(){return Object(c["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://safe-river-16409.herokuapp.com/api/grabscore",{credentials:"include"});case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)})))()},checkriderdest:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.allLinks.getnewlat(t.theuserid);case 2:return t.lat=n.sent,n.next=5,t.allLinks.getnewlng(t.theuserid);case 5:return t.long=n.sent,t.userposition.setLatLng([t.lat,t.long]),n.next=9,t.getscore();case 9:if(t.score=n.sent,r=Math.pow(Math.pow(t.requesteddropofflat-t.lat,2)+Math.pow(t.requesteddropofflong-t.long,2),.5),!(r<.003)){n.next=20;break}return t.requested=!1,n.next=15,fetch("https://safe-river-16409.herokuapp.com/api/changerequestedfalse",{credentials:"include"});case 15:if(t.score!=e){n.next=18;break}return n.next=18,t.waitfordriver(e);case 18:n.next=22;break;case 20:return n.next=22,t.checkriderdest();case 22:case"end":return n.stop()}}),n)})))()},acgiveride:function(e,t,n,r,i,a){var o=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var c,u,p;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,o.allLinks.getnewlat(o.theuserid);case 2:return o.lat=s.sent,s.next=5,o.allLinks.getnewlng(o.theuserid);case 5:if(o.long=s.sent,c=Math.pow(Math.pow(n-o.lat,2)+Math.pow(r-o.long,2),.5),u=Math.pow(Math.pow(69.172*(n-o.lat),2)+Math.pow((r-o.long)*Math.cos((n-o.lat)/2*(Math.PI/180))*69.172,2),.5),o.thegiveridepopups[e].setContent("Go to"+t+"("+u+"miles away)"),!(c<.003)){s.next=18;break}return o.enroute=!0,p=Math.pow(Math.pow(69.172*(n-i),2)+Math.pow((r-a)*Math.cos((n-i)/2*(Math.PI/180))*69.172,2),.5),o.cost=p,o.thegiveridepopups[e].setContent("Drive"+t+"to the destination("+p+"miles away)"),s.next=16,o.checkdest(e,t,i,a);case 16:s.next=20;break;case 18:return s.next=20,o.acgiveride(e,t,n,r,i,a);case 20:case"end":return s.stop()}}),s)})))()},getgive:function(){return Object(c["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://safe-river-16409.herokuapp.com/api/getusergive",{credentials:"include"});case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)})))()},beforeacgiveride:function(e,t,n,r,i,a){var o=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var c,u,p,l,d,h;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,o.use();case 2:if(c=s.sent,o.theuserid=c.id,void 0!=o.theuserid||0!=o.loggedin){s.next=11;break}return window.location.assign("https://safe-river-16409.herokuapp.com/api/auth/login"),o.loggedin=!0,s.next=9,o.beforeacgiveride(e,t,n,r,i,a);case 9:s.next=35;break;case 11:if(void 0!=o.theuserid||1!=o.loggedin){s.next=20;break}return s.next=14,o.use();case 14:return u=s.sent,o.theuserid=u.id,s.next=18,o.beforeacgiveride(e,t,n,r,i,a);case 18:s.next=35;break;case 20:return s.next=22,o.getgive();case 22:if(o.givingans=s.sent,void 0==o.givingans.giving||"False"==o.givingans.giving?o.giving=!1:o.giving=!0,console.log(o.giving),void 0==o.givingans.requested||"False"==o.givingans.requested?o.requested=!1:o.requested=!0,0!=o.giving||0!=o.requested){s.next=34;break}return o.giving=!0,s.next=30,fetch("https://safe-river-16409.herokuapp.com/api/changegive",{credentials:"include"});case 30:return s.next=32,o.acgiveride(e,t,n,r,i,a);case 32:s.next=35;break;case 34:1==o.giving&&0==o.requested?(b["DomEvent"].on(o.okbtns[e],"click",(function(){o.goback(e)})),p=document.createElement("div"),l=document.createTextNode("Error: you must complete your current ride first."),p.appendChild(l),p.appendChild(o.okbtns[e]),o.thegiveridepopups[e].setContent(p)):(b["DomEvent"].on(o.okbtns[e],"click",(function(){o.goback(e)})),d=document.createElement("div"),h=document.createTextNode("Error: you must cancel your current ride request or complete it in order to give a ride."),d.appendChild(h),d.appendChild(o.okbtns[e]),o.thegiveridepopups[e].setContent(d));case 35:case"end":return s.stop()}}),s)})))()},giveride:function(e,t,n,r,i,a,o){var s=this;return Object(c["a"])(regeneratorRuntime.mark((function c(){var u,p;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:s.riderid=t,b["DomEvent"].on(s.yesbtns[e],"click",(function(){s.beforeacgiveride(e,n,r,i,a,o)})),b["DomEvent"].on(s.nobtns[e],"click",(function(){s.goback(e)})),u=document.createElement("div"),p=document.createTextNode("Are your sure? Other users can tell if you failed to complete this ride."),u.appendChild(p),u.appendChild(s.yesbtns[e]),u.appendChild(s.nobtns[e]),s.thegiveridepopups[e].setContent(u);case 9:case"end":return c.stop()}}),c)})))()},checkdest:function(e,t,n,r){var i=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var o,s,c,u;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,i.getriderlat(i.riderid);case 2:return o=a.sent,a.next=5,i.getriderlong(i.riderid);case 5:return s=a.sent,a.next=8,i.allLinks.getnewlat(i.theuserid);case 8:return i.lat=a.sent,a.next=11,i.allLinks.getnewlng(i.theuserid);case 11:if(i.long=a.sent,i.userposition.setLatLng([i.lat,i.long]),c=Math.pow(Math.pow(o-n,2)+Math.pow(s-r,2),.5),u=Math.pow(Math.pow(69.172*(o-n),2)+Math.pow((s-r)*Math.cos((o-n)/2*(Math.PI/180))*69.172,2),.5),!(c<.003)){a.next=26;break}return i.giving=!1,a.next=19,fetch("https://safe-river-16409.herokuapp.com/api/changegivefalse",{credentials:"include"});case 19:return a.next=21,fetch("https://safe-river-16409.herokuapp.com/api/finished?cost="+i.cost+"&rider="+i.riderid,{credentials:"include"});case 21:return a.next=23,i.getscore();case 23:i.score=a.sent,a.next=30;break;case 26:return i.thegiveridepopups[e].setContent("Drive"+t+"to the destination("+u+"miles away)"),i.thegiveridepopups[e].setLatLng([o,s]),a.next=30,i.checkdest(n,r);case 30:case"end":return a.stop()}}),a)})))()},use:function(){return Object(c["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://safe-river-16409.herokuapp.com/api/user",{credentials:"include"});case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)})))()},goback:function(e){this.thegiveridepopups[e].setContent(this.thebtns[e])},confirm:function(e){var t=this;this.thepopup.setLatLng([e.latlng.lat+.003/Math.pow(this.map.getZoom(),9)*Math.pow(13,9),e.latlng.lng]);var n=b["DomUtil"].create("div"),r=b["DomUtil"].create("button","",n),i=b["DomUtil"].create("button","",n);r.setAttribute("type","button"),i.setAttribute("type","button"),r.innerHTML="confirm pickup",i.innerHTML="cancel",b["DomEvent"].on(r,"click",(function(){t.conpick()})),b["DomEvent"].on(i,"click",(function(){t.thepopup.remove(),t.pickuploc.remove(),t.otherreqstatus=!1}));var a=document.createElement("div");a.appendChild(r),a.appendChild(i),this.thepopup.setContent(a),this.thepopup.openOn(this.map)},confirm2:function(e){var t=this;this.thepopup.setLatLng([e.latlng.lat+.003/Math.pow(this.map.getZoom(),9)*Math.pow(13,9),e.latlng.lng]);var n=b["DomUtil"].create("div"),r=b["DomUtil"].create("button","",n),i=b["DomUtil"].create("button","",n);r.setAttribute("type","button"),i.setAttribute("type","button"),r.innerHTML="confirm dropoff",i.innerHTML="cancel",b["DomEvent"].on(r,"click",Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.condrop();case 2:case"end":return e.stop()}}),e)})))),b["DomEvent"].on(i,"click",(function(){t.reqpickuploc.remove(),t.thert.remove(),t.thepopup.remove(),t.pickuploc.remove(),t.otherreqstatus=!1}));var a=document.createElement("div");a.appendChild(r),a.appendChild(i),this.thepopup.setContent(a),this.thepopup.openOn(this.map)},changepop:function(){this.thepopup.setLatLng([this.pickuploc.getLatLng().lat+.003/Math.pow(this.map.getZoom(),9)*Math.pow(13,9),this.pickuploc.getLatLng().lng])},setpickup:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,r,i,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(void 0!=e.theuserid){t.next=4;break}e.requested=!1,t.next=9;break;case 4:return t.next=6,e.getgive();case 6:e.givingans=t.sent,console.log(e.givingans.requested),void 0==e.givingans.requested||"False"==e.givingans.requested?e.requested=!1:e.requested=!0;case 9:if(0!=e.requested||0!=e.otherreqstatus){t.next=37;break}e.otherreqstatus=!0,n=b["icon"]({iconUrl:q.a,iconSize:[20,20],iconAnchor:[10.5,20]}),e.pickuploc=b["marker"]([e.lat,e.long],{icon:n,draggable:"True"}).addTo(e.map),e.provider=new w["b"],e.searchControl=new w["a"]({provider:e.provider,showMarker:!1}),e.map.addControl(e.searchControl),e.map.on("geosearch/showlocation",e.work),e.thepopup=b["popup"]({closeButton:!1,closeOnClick:!1}),e.thepopup.setLatLng([e.lat+.003/Math.pow(e.map.getZoom(),9)*Math.pow(13,9),e.long]),e.map.on("zoomend",e.changepop),r=b["DomUtil"].create("div"),i=b["DomUtil"].create("button","",r),a=b["DomUtil"].create("button","",r),i.setAttribute("type","button"),a.setAttribute("type","button"),i.innerHTML="confirm pickup",a.innerHTML="cancel",b["DomEvent"].on(i,"click",(function(){e.conpick()})),b["DomEvent"].on(a,"click",(function(){e.pickuploc.remove()})),o=document.createElement("div"),o.appendChild(i),o.appendChild(a),e.thepopup.setContent(o),e.thepopup.openOn(e.map),e.pickuploc.on("move",e.confirm),t.next=47;break;case 37:if(1!=e.otherreqstatus){t.next=41;break}alert("Already requesting, drag pin to set pickup location"),t.next=47;break;case 41:return e.requested=!1,t.next=44,fetch("https://safe-river-16409.herokuapp.com/api/changerequestedfalse",{credentials:"include"});case 44:e.reqstatus="request ride",e.otherreqstatus=!1,"test"!=e.reqpickuploc&&(e.reqpickuploc.remove(),e.reqdropoffloc.remove(),e.thert.remove());case 47:case"end":return t.stop()}}),t)})))()},setupmap:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.map=b["map"]("mapContainer").setView([e.lat,e.long],13),b["tileLayer"]("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1}).addTo(e.map),e.userposition=b["circle"]([e.lat,e.long],{color:"blue",fillColor:"blue",fillOpacity:.5,radius:25}).addTo(e.map),t.next=5,e.getrides();case 5:for(n=t.sent,r=0,i=function(t){if(e.values=Object.values(n[0].Location36n79[0]),e.inds.push(r),""!=e.values[t][0].requestedpickuplat&&void 0!=e.values[t][0].requestedpickuplat&&e.values[t][0].name!=e.theuserid){o=b["polygon"]([[e.values[t][0].requestedpickuplat,e.values[t][0].requestedpickuplong],[e.values[t][0].requesteddropofflat,e.values[t][0].requesteddropofflong]]).addTo(e.map),e.thegiveridepopups.push(b["popup"]({closeButton:!1,closeOnClick:!1})),s=b["DomUtil"].create("div"),e.thebtns.push(b["DomUtil"].create("button","",s)),e.thebtns[r].setAttribute("type","button"),e.thebtns[r].innerHTML="give ride",b["DomEvent"].on(e.thebtns[r],"click",(function(){e.giveride(e.inds[t],e.values[t][0].name,e.values[t][0].acname,e.values[t][0].requestedpickuplat,e.values[t][0].requestedpickuplong,e.values[t][0].requesteddropofflat,e.values[t][0].requesteddropofflong)})),e.yesbtns.push(b["DomUtil"].create("button","",s)),e.yesbtns[r].setAttribute("type","button"),e.yesbtns[r].innerHTML="Yes",e.nobtns.push(b["DomUtil"].create("button","",s)),e.nobtns[r].setAttribute("type","button"),e.nobtns[r].innerHTML="No",e.okbtns.push(b["DomUtil"].create("button","",s)),e.okbtns[r].setAttribute("type","button"),e.okbtns[r].innerHTML="OK",e.thegiveridepopups[r].setContent(e.thebtns[r]),o.bindPopup(e.thegiveridepopups[r]);var i=b["circle"]([e.values[t][0].requestedpickuplat,e.values[t][0].requestedpickuplong],{color:"blue",fillColor:"blue",fillOpacity:.5,radius:25}).addTo(e.map);i.bindPopup(e.thegiveridepopups[r]);var a=b["circle"]([e.values[t][0].requesteddropofflat,e.values[t][0].requesteddropofflong],{color:"red",fillColor:"red",fillOpacity:.5,radius:25}).addTo(e.map);a.bindPopup(e.thegiveridepopups[r]),r+=1}},a=0;a<Object.values(n[0].Location36n79[0]).length;a++)i(a);case 9:case"end":return t.stop()}}),t)})))()},addLink:function(e){console.log("EVENT: add new item ".concat(e.name," to ").concat(this.linkGroup.title)),this.$emit("new-link",this.groupId,e)}},mounted:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.use();case 2:return n=t.sent,e.theuserid=n.id,console.log(e.theuserid),t.next=7,e.allLinks.getnewlat(e.theuserid);case 7:return r=t.sent,t.next=10,e.allLinks.getnewlng(e.theuserid);case 10:if(i=t.sent,e.lat=r,e.long=i,e.setupmap(),e.isloading="",void 0==e.theuserid){t.next=40;break}return t.next=18,e.getgive();case 18:return e.givingans=t.sent,t.next=21,e.getscore();case 21:if(e.score=t.sent,"True"!=e.givingans.requested){t.next=32;break}return e.reqstatus="Cancel request (5 mile penalty)",e.requested=!0,e.reqpickuploc=b["circle"]([e.givingans.requestedpickuplat,e.givingans.requestedpickuplong],{color:"green",fillColor:"green",fillOpacity:.5,radius:25}).addTo(e.map),e.thert=b["polygon"]([[e.givingans.requestedpickuplat,e.givingans.requestedpickuplong],[e.givingans.requesteddropofflat,e.givingans.requesteddropofflong]]).addTo(e.map),e.reqdropoffloc=b["circle"]([e.givingans.requesteddropofflat,e.givingans.requesteddropofflong],{color:"red",fillColor:"red",fillOpacity:.5,radius:25}).addTo(e.map),t.next=30,e.checkriderdest();case 30:t.next=33;break;case 32:e.requested=!1;case 33:if("True"!=e.givingans.giving){t.next=39;break}return e.giving,t.next=37,e.checkdest();case 37:t.next=40;break;case 39:e.giving=!1;case 40:case"end":return t.stop()}}),t)})))()}},L=y,O=(n("ba75"),n("2877")),M=Object(O["a"])(L,m,k,!1,null,"f6c37cea",null),R=M.exports,j={name:"App",components:{TheMap:R},data:function(){return{allLinks:v,apiUrlBase:"https://safe-river-16409.herokuapp.com/",latit:"",longit:""}},methods:{setTitle:function(e,t){console.log("CAUGHT: new title ".concat(t," to replace ").concat(this.allLinks.data[e].title)),this.allLinks.setTitle(e,t)},addLink:function(e,t){console.log("CAUGHT: add new item ".concat(t.name," to ").concat(this.allLinks.data[e].title)),this.allLinks.addLink(e,t)}},mounted:function(){console.log(9),console.log(this.apiUrlBase+"api/auth/login")}},C=j,T=Object(O["a"])(C,o,s,!1,null,null,null),D=T.exports;n("38c8");r["default"].config.productionTip=!1,new r["default"]({render:function(e){return e(D)}}).$mount("#app")},"7faa":function(e,t,n){e.exports=n.p+"img/pin.239c8c58.png"},ba75:function(e,t,n){"use strict";n("d036")},d036:function(e,t,n){}});
//# sourceMappingURL=app.bd28d576.js.map